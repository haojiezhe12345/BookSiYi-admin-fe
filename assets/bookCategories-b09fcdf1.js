import{D as V,H as $,I as B,F}from"./base-bb3a9cd4.js";import{b as D,a as K,c as x,E as z}from"./input-0dfebaa5.js";import{E as l,a as M}from"./text-f58459f4.js";import{d as S,r as T,o as U,b as f,i as y,w as c,f as n,g as v,k as m,c as A,K as H,F as L,u as R,a as _,e as q,h as G,z as k,A as h,_ as J}from"./index-7c7dea94.js";import"./aria-60e0cdc6.js";const O={style:{display:"flex"}},P=S({__name:"bookCategories",setup(Q){const C=R(),t=T([{id:-1,categoryName:"",editing:!1}]);function N(e){t.value[e].editing=!0}function b(){t.value.push({id:-1,categoryName:"",editing:!0})}function p(e){var i=t.value[e].id;i==-1?_.post("/admin/bookcategory/add",null,{params:{categoryName:t.value[e].categoryName}}).then(a=>{a.data.code==1?(r(),l.success("添加成功"),t.value[e].editing=!1):l.error(`添加失败: ${a.data.msg}`)}):_.put("/admin/bookcategory/update",{id:i,categoryName:t.value[e].categoryName}).then(a=>{a.data.code==1?(r(),l.success("修改成功"),t.value[e].editing=!1):l.error(`修改失败: ${a.data.msg}`)})}function w(e){var i=t.value[e].id;if(i==-1){t.value.splice(e,1);return}_.delete("/admin/bookcategory/delete",{params:{ids:i}}).then(a=>{a.data.code==1?(r(),l.success("删除成功")):l.error(`删除失败: ${a.data.msg}`)})}function r(){_.get("/admin/bookcategory/getcategoryInfo").then(e=>{if(e.data.data===null){C.push("/login");return}t.value=e.data.data}).catch(()=>{l.error("数据加载失败")})}return U(()=>{r()}),(e,i)=>{const a=M,d=D,g=K,E=z,I=x;return f(),y(I,{"label-width":"auto","label-position":"left",style:{padding:"12px"}},{default:c(()=>[n(g,null,{default:c(()=>[n(a,null,{default:c(()=>[v("书籍分类：")]),_:1}),n(d,{type:"primary",size:"small",icon:m(V),plain:"",onClick:b},{default:c(()=>[v("添加")]),_:1},8,["icon"])]),_:1}),(f(!0),A(L,null,H(t.value,(o,u)=>(f(),y(g,{label:o.id!=-1?o.id.toString():" ",key:o.id},{default:c(()=>[q("div",O,[n(E,{modelValue:o.categoryName,"onUpdate:modelValue":s=>o.categoryName=s,disabled:o.editing!=!0,onKeydown:G(s=>p(u),["enter","native"])},null,8,["modelValue","onUpdate:modelValue","disabled","onKeydown"]),k(n(d,{type:"warning",plain:"",icon:m($),circle:"",onClick:s=>N(u)},null,8,["icon","onClick"]),[[h,o.editing!=!0]]),k(n(d,{type:"success",plain:"",icon:m(B),circle:"",onClick:s=>p(u)},null,8,["icon","onClick"]),[[h,o.editing==!0]]),n(d,{type:"danger",plain:"",icon:m(F),circle:"",onClick:s=>w(u)},null,8,["icon","onClick"])])]),_:2},1032,["label"]))),128))]),_:1})}}});const ee=J(P,[["__scopeId","data-v-f6ff96f7"]]);export{ee as default};
