import{b as Se,f as de,m as fe,y as R,i as ve,z as he,A as be,B as xe,C as Te,u as Ae,E as me,_ as Ee,h as _e,w as Ie,D as se,F as ye}from"./base-bb3a9cd4.js";import{E as Le,a as Ne,b as ke,c as De,d as Oe,e as Ue,f as $e}from"./table-column-f50dbfa4.js";import{u as Be,C as Ke,U as Z,d as Me,e as He,b as Pe,E as Fe,a as je,c as Re}from"./input-0dfebaa5.js";import{E as Je}from"./pagination-07fe6fb6.js";import"./scrollbar-cd73b27d.js";import"./popper-f3ef1ed3.js";import"./tooltip-15a256c2.js";import{E as L,a as Ge}from"./text-f58459f4.js";/* empty css             */import{d as ze,n as Ve,r as h,l as w,q as We,b as z,c as g,F as N,K as J,I as M,k as d,f as a,w as n,z as O,i as k,L as Q,A as U,M as re,N as ie,J as G,O as pe,D as we,P as ce,y as Ce,o as qe,e as H,g as v,u as Xe,a as j}from"./index-7c7dea94.js";import{t as ge}from"./utils-d837aa94.js";import{E as Y}from"./aria-60e0cdc6.js";const Qe=Se({modelValue:{type:Number,default:0},id:{type:String,default:void 0},lowThreshold:{type:Number,default:2},highThreshold:{type:Number,default:4},max:{type:Number,default:5},colors:{type:de([Array,Object]),default:()=>fe(["","",""])},voidColor:{type:String,default:""},disabledVoidColor:{type:String,default:""},icons:{type:de([Array,Object]),default:()=>[R,R,R]},voidIcon:{type:ve,default:()=>he},disabledVoidIcon:{type:ve,default:()=>R},disabled:Boolean,allowHalf:Boolean,showText:Boolean,showScore:Boolean,textColor:{type:String,default:""},texts:{type:de(Array),default:()=>fe(["Extremely bad","Disappointed","Fair","Satisfied","Surprise"])},scoreTemplate:{type:String,default:"{value}"},size:Be,label:{type:String,default:void 0},clearable:{type:Boolean,default:!1}}),Ye={[Ke]:$=>be($),[Z]:$=>be($)},Ze=["id","aria-label","aria-labelledby","aria-valuenow","aria-valuetext","aria-valuemax"],el=["onMousemove","onClick"],ll=ze({name:"ElRate"}),al=ze({...ll,props:Qe,emits:Ye,setup($,{expose:ee,emit:x}){const o=$;function B(u,s){const r=p=>we(p),V=Object.keys(s).map(p=>+p).filter(p=>{const S=s[p];return(r(S)?S.excluded:!1)?u<p:u<=p}).sort((p,S)=>p-S),t=s[V[0]];return r(t)&&t.value||t}const C=Ve(xe,void 0),A=Ve(Te,void 0),E=Me(),e=Ae("rate"),{inputId:le,isLabeledByFormItem:W}=He(o,{formItemContext:A}),f=h(o.modelValue),P=h(-1),I=h(!0),ae=w(()=>[e.b(),e.m(E.value)]),y=w(()=>o.disabled||(C==null?void 0:C.disabled)),te=w(()=>e.cssVarBlock({"void-color":o.voidColor,"disabled-void-color":o.disabledVoidColor,"fill-color":l.value})),q=w(()=>{let u="";return o.showScore?u=o.scoreTemplate.replace(/\{\s*value\s*\}/,y.value?`${o.modelValue}`:`${f.value}`):o.showText&&(u=o.texts[Math.ceil(f.value)-1]),u}),T=w(()=>o.modelValue*100-Math.floor(o.modelValue)*100),i=w(()=>pe(o.colors)?{[o.lowThreshold]:o.colors[0],[o.highThreshold]:{value:o.colors[1],excluded:!0},[o.max]:o.colors[2]}:o.colors),l=w(()=>{const u=B(f.value,i.value);return we(u)?"":u}),c=w(()=>{let u="";return y.value?u=`${T.value}%`:o.allowHalf&&(u="50%"),{color:l.value,width:u}}),b=w(()=>{let u=pe(o.icons)?[...o.icons]:{...o.icons};return u=ce(u),pe(u)?{[o.lowThreshold]:u[0],[o.highThreshold]:{value:u[1],excluded:!0},[o.max]:u[2]}:u}),oe=w(()=>B(o.modelValue,b.value)),K=w(()=>y.value?Ce(o.disabledVoidIcon)?o.disabledVoidIcon:ce(o.disabledVoidIcon):Ce(o.voidIcon)?o.voidIcon:ce(o.voidIcon)),ue=w(()=>B(f.value,b.value));function X(u){const s=y.value&&T.value>0&&u-1<o.modelValue&&u>o.modelValue,r=o.allowHalf&&I.value&&u-.5<=f.value&&u>f.value;return s||r}function _(u){o.clearable&&u===o.modelValue&&(u=0),x(Z,u),o.modelValue!==u&&x("change",u)}function m(u){y.value||(o.allowHalf&&I.value?_(f.value):_(u))}function ne(u){if(y.value)return;let s=f.value;const r=u.code;return r===Y.up||r===Y.right?(o.allowHalf?s+=.5:s+=1,u.stopPropagation(),u.preventDefault()):(r===Y.left||r===Y.down)&&(o.allowHalf?s-=.5:s-=1,u.stopPropagation(),u.preventDefault()),s=s<0?0:s,s=s>o.max?o.max:s,x(Z,s),x("change",s),s}function D(u,s){if(!y.value){if(o.allowHalf&&s){let r=s.target;_e(r,e.e("item"))&&(r=r.querySelector(`.${e.e("icon")}`)),(r.clientWidth===0||_e(r,e.e("decimal")))&&(r=r.parentNode),I.value=s.offsetX*2<=r.clientWidth,f.value=I.value?u-.5:u}else f.value=u;P.value=u}}function F(){y.value||(o.allowHalf&&(I.value=o.modelValue!==Math.floor(o.modelValue)),f.value=o.modelValue,P.value=-1)}return We(()=>o.modelValue,u=>{f.value=u,I.value=o.modelValue!==Math.floor(o.modelValue)}),o.modelValue||x(Z,0),ee({setCurrentValue:D,resetCurrentValue:F}),(u,s)=>{var r;return z(),g("div",{id:d(le),class:M([d(ae),d(e).is("disabled",d(y))]),role:"slider","aria-label":d(W)?void 0:u.label||"rating","aria-labelledby":d(W)?(r=d(A))==null?void 0:r.labelId:void 0,"aria-valuenow":f.value,"aria-valuetext":d(q)||void 0,"aria-valuemin":"0","aria-valuemax":u.max,tabindex:"0",style:ie(d(te)),onKeydown:ne},[(z(!0),g(N,null,J(u.max,(V,t)=>(z(),g("span",{key:t,class:M(d(e).e("item")),onMousemove:p=>D(V,p),onMouseleave:F,onClick:p=>m(V)},[a(d(me),{class:M([d(e).e("icon"),{hover:P.value===V},d(e).is("active",V<=f.value)])},{default:n(()=>[X(V)?re("v-if",!0):(z(),g(N,{key:0},[O((z(),k(Q(d(ue)),null,null,512)),[[U,V<=f.value]]),O((z(),k(Q(d(K)),null,null,512)),[[U,!(V<=f.value)]])],64)),X(V)?(z(),g(N,{key:1},[(z(),k(Q(d(K)),{class:M([d(e).em("decimal","box")])},null,8,["class"])),a(d(me),{style:ie(d(c)),class:M([d(e).e("icon"),d(e).e("decimal")])},{default:n(()=>[(z(),k(Q(d(oe))))]),_:1},8,["style","class"])],64)):re("v-if",!0)]),_:2},1032,["class"])],42,el))),128)),u.showText||u.showScore?(z(),g("span",{key:0,class:M(d(e).e("text")),style:ie({color:u.textColor})},G(d(q)),7)):re("v-if",!0)],46,Ze)}}});var tl=Ee(al,[["__file","rate.vue"]]);const ol=Ie(tl);const ul={style:{display:"flex","flex-direction":"column",height:"100%"}},nl={style:{display:"flex",gap:"8px",padding:"8px"}},dl={style:{"text-wrap":"nowrap"}},sl={style:{display:"flex",gap:"8px",width:"100%"}},rl={style:{display:"flex",gap:"8px",width:"100%"}},il={style:{flex:"auto"}},Sl=ze({__name:"puzzles",setup($){const ee=Xe(),x=h(1),o=h(10),B=h(0),C=h([{clue:"clue",createTime:"1970",deleted:0,displayOrder:0,id:0,puzzleAnswer:"answer",puzzleKinds:0,puzzleName:"name",puzzleScore:0,puzzleStatus:0,puzzleType:0,star:0,updateTime:"1970",userId:0,version:0}]),A=h(!1),E=h("new"),e=h({clue:"clue",displayOrder:0,id:0,labelList:[{labelName:"tag"}],optionList:[{selectContent:"label",tbSelect:"A"}],puzzleAnswerStr:"answer",puzzleAnswerList:[],puzzleContent:{contentText:"question",media:"url"},puzzleKinds:0,puzzleName:"name",puzzleScore:0,puzzleStatus:0,puzzleType:0,star:0,userId:0});function le(){E.value="new",e.value={clue:"",displayOrder:0,id:0,labelList:[],optionList:[],puzzleAnswerStr:"",puzzleAnswerList:[],puzzleContent:{contentText:"",media:""},puzzleKinds:0,puzzleName:"",puzzleScore:0,puzzleStatus:0,puzzleType:0,star:0,userId:0},A.value=!0}function W(i){j.get("/admin/puzzle/list/"+C.value[i].id).then(l=>{if(l.data.code==1){if(e.value.clue=C.value[i].clue,e.value.displayOrder=l.data.data.displayOrder,e.value.id=C.value[i].id,e.value.labelList=l.data.data.labelList,e.value.optionList=l.data.data.optionList!=null?l.data.data.optionList:[],l.data.data.puzzleType==0)e.value.puzzleAnswerStr=l.data.data.puzzleAnswer,e.value.puzzleAnswerList=[];else if(l.data.data.puzzleType==1){e.value.puzzleAnswerStr="";try{e.value.puzzleAnswerList=JSON.parse(l.data.data.puzzleAnswer)}catch{e.value.puzzleAnswerList=[]}}e.value.puzzleContent=l.data.data.puzzleContentDTO,e.value.puzzleKinds=l.data.data.puzzleKinds,e.value.puzzleName=l.data.data.puzzleName,e.value.puzzleScore=l.data.data.puzzleScore,e.value.puzzleStatus=C.value[i].puzzleStatus,e.value.puzzleType=l.data.data.puzzleType,e.value.star=l.data.data.star,e.value.userId=C.value[i].userId,E.value="update",A.value=!0}else L.error(`获取谜题详细信息失败: ${l.data.msg}`)})}function f(){e.value.labelList.push({labelName:""})}function P(i){e.value.labelList.splice(i,1)}function I(){e.value.optionList.push({selectContent:"",tbSelect:""})}function ae(i){e.value.optionList.splice(i,1)}function y(){A.value=!1}function te(){for(var i=0;i<e.value.optionList.length;i++)e.value.optionList[i].tbSelect=String.fromCharCode("A".charCodeAt(0)+i);var l=JSON.parse(JSON.stringify(e.value));l.puzzleType==0?l.puzzleAnswer=l.puzzleAnswerStr:l.puzzleType==1&&(l.puzzleAnswer=JSON.stringify(l.puzzleAnswerList)),delete l.puzzleAnswerStr,delete l.puzzleAnswerList,E.value=="new"?(l.puzzleContentDTO=l.puzzleContent,delete l.puzzleContent,delete l.id,delete l.puzzleStatus,j.put("/admin/puzzle/",l).then(c=>{c.data.code==1?(y(),T(),L.success("保存成功")):L.error(`保存失败: ${c.data.msg}`)})):E.value=="update"&&j.put("/admin/puzzle/update",l).then(c=>{c.data.code==1?(y(),T(),L.success("保存成功")):L.error(`保存失败: ${c.data.msg}`)})}function q(i){var l=C.value[i].id;j.delete("/admin/puzzle/",{data:[l]}).then(c=>{c.data.code==1?(T(),L.success("删除成功")):L.error(`删除失败: ${c.data.msg}`)})}function T(){j.post("/admin/puzzle/page",{pageNo:x.value,pageSize:o.value}).then(i=>{if(i.data.data===null){ee.push("/login");return}C.value=i.data.data.records,B.value=i.data.data.total}).catch(()=>{L.error("数据加载失败")})}return qe(()=>{T()}),(i,l)=>{const c=Pe,b=Le,oe=me,K=Ge,ue=Ne,X=Je,_=Fe,m=je,ne=ol,D=ke,F=De,u=$e,s=Oe,r=Re,V=Ue;return z(),g(N,null,[H("div",ul,[H("div",nl,[a(c,{type:"primary",icon:d(se),onClick:le},{default:n(()=>[v("添加谜题")]),_:1},8,["icon"])]),a(ue,{data:C.value,"table-layout":"auto"},{default:n(()=>[a(b,{prop:"id",label:"ID"}),a(b,{prop:"puzzleName",label:"名称"}),a(b,{prop:"clue",label:"线索"}),a(b,{prop:"puzzleAnswer",label:"答案"}),a(b,{prop:"star",label:"难度"},{default:n(t=>[(z(!0),g(N,null,J(t.row.star,p=>(z(),k(oe,null,{default:n(()=>[a(d(R))]),_:1}))),256))]),_:1}),a(b,{prop:"puzzleType",label:"类型"},{default:n(t=>[v(G(t.row.puzzleType==1?"选择":"填空"),1)]),_:1}),a(b,{prop:"puzzleKinds",label:"风格"}),a(b,{prop:"puzzleScore",label:"积分"}),a(b,{prop:"puzzleStatus",label:"审核状态"},{default:n(t=>[a(K,{type:t.row.puzzleStatus==1?"success":"warning"},{default:n(()=>[v(G(t.row.puzzleStatus==1?"通过":"待审"),1)]),_:2},1032,["type"])]),_:1}),a(b,{prop:"createTime",label:"创建时间"},{default:n(t=>[v(G(d(ge)(t.row.createTime)),1)]),_:1}),a(b,{prop:"updateTime",label:"修改时间"},{default:n(t=>[v(G(d(ge)(t.row.updateTime)),1)]),_:1}),a(b,{prop:"userId",label:"userId"}),a(b,{label:"操作",fixed:"right"},{default:n(t=>[H("div",dl,[a(c,{link:"",type:"primary",size:"small",onClick:p=>W(t.$index)},{default:n(()=>[v("编辑")]),_:2},1032,["onClick"]),a(c,{link:"",type:"primary",size:"small",onClick:p=>q(t.$index)},{default:n(()=>[v("删除")]),_:2},1032,["onClick"])])]),_:1})]),_:1},8,["data"]),a(X,{style:{padding:"8px"},"current-page":x.value,"onUpdate:currentPage":l[0]||(l[0]=t=>x.value=t),"page-size":o.value,"onUpdate:pageSize":l[1]||(l[1]=t=>o.value=t),"page-sizes":[10,25,50,100],layout:"total, sizes, prev, pager, next, jumper",total:B.value,onSizeChange:T,onCurrentChange:T},null,8,["current-page","page-size","total"])]),a(V,{modelValue:A.value,"onUpdate:modelValue":l[16]||(l[16]=t=>A.value=t),title:`编辑 "${e.value.puzzleName}"`},{footer:n(()=>[H("div",il,[a(c,{onClick:y},{default:n(()=>[v("取消")]),_:1}),a(c,{type:"primary",onClick:te},{default:n(()=>[v("保存")]),_:1})])]),default:n(()=>[a(r,{model:e.value},{default:n(()=>[a(m,{label:"名称"},{default:n(()=>[a(_,{modelValue:e.value.puzzleName,"onUpdate:modelValue":l[2]||(l[2]=t=>e.value.puzzleName=t)},null,8,["modelValue"])]),_:1}),a(m,{label:"风格"},{default:n(()=>[a(_,{modelValue:e.value.puzzleKinds,"onUpdate:modelValue":l[3]||(l[3]=t=>e.value.puzzleKinds=t)},null,8,["modelValue"])]),_:1}),a(m,{label:"问题"},{default:n(()=>[a(_,{modelValue:e.value.puzzleContent.contentText,"onUpdate:modelValue":l[4]||(l[4]=t=>e.value.puzzleContent.contentText=t)},null,8,["modelValue"])]),_:1}),a(m,{label:"图片"},{default:n(()=>[a(_,{modelValue:e.value.puzzleContent.media,"onUpdate:modelValue":l[5]||(l[5]=t=>e.value.puzzleContent.media=t)},null,8,["modelValue"])]),_:1}),a(m,{label:"线索"},{default:n(()=>[a(_,{modelValue:e.value.clue,"onUpdate:modelValue":l[6]||(l[6]=t=>e.value.clue=t)},null,8,["modelValue"])]),_:1}),a(m,{label:"难度"},{default:n(()=>[a(ne,{modelValue:e.value.star,"onUpdate:modelValue":l[7]||(l[7]=t=>e.value.star=t)},null,8,["modelValue"])]),_:1}),a(m,{label:"答案类型"},{default:n(()=>[a(F,{modelValue:e.value.puzzleType,"onUpdate:modelValue":l[8]||(l[8]=t=>e.value.puzzleType=t)},{default:n(()=>[a(D,{label:0},{default:n(()=>[v("填空")]),_:1}),a(D,{label:1},{default:n(()=>[v("选择")]),_:1})]),_:1},8,["modelValue"])]),_:1}),O(a(m,{label:"答案"},{default:n(()=>[a(_,{modelValue:e.value.puzzleAnswerStr,"onUpdate:modelValue":l[9]||(l[9]=t=>e.value.puzzleAnswerStr=t)},null,8,["modelValue"])]),_:1},512),[[U,e.value.puzzleType==0]]),O(a(m,{label:"答案"},{default:n(()=>[a(s,{modelValue:e.value.puzzleAnswerList,"onUpdate:modelValue":l[10]||(l[10]=t=>e.value.puzzleAnswerList=t)},{default:n(()=>[(z(!0),g(N,null,J(e.value.optionList,(t,p)=>(z(),k(u,{label:String.fromCharCode("A".charCodeAt(0)+p)},null,8,["label"]))),256))]),_:1},8,["modelValue"])]),_:1},512),[[U,e.value.puzzleType==1]]),O(a(r,{"label-width":"auto","label-position":"left"},{default:n(()=>[a(m,null,{default:n(()=>[a(K,null,{default:n(()=>[v("选项：")]),_:1}),a(c,{type:"primary",size:"small",icon:d(se),plain:"",onClick:I},{default:n(()=>[v("添加")]),_:1},8,["icon"])]),_:1}),(z(!0),g(N,null,J(e.value.optionList,(t,p)=>(z(),k(m,{label:String.fromCharCode("A".charCodeAt(0)+p)},{default:n(()=>[H("div",sl,[a(_,{modelValue:t.selectContent,"onUpdate:modelValue":S=>t.selectContent=S},null,8,["modelValue","onUpdate:modelValue"]),a(c,{type:"danger",plain:"",icon:d(ye),circle:"",onClick:S=>ae(p)},null,8,["icon","onClick"])])]),_:2},1032,["label"]))),256))]),_:1},512),[[U,e.value.puzzleType==1]]),a(r,{"label-width":"auto"},{default:n(()=>[a(m,null,{default:n(()=>[a(K,null,{default:n(()=>[v("谜题标签：")]),_:1}),a(c,{type:"primary",size:"small",icon:d(se),plain:"",onClick:f},{default:n(()=>[v("添加")]),_:1},8,["icon"])]),_:1}),(z(!0),g(N,null,J(e.value.labelList,(t,p)=>(z(),k(m,null,{default:n(()=>[H("div",rl,[a(_,{modelValue:t.labelName,"onUpdate:modelValue":S=>t.labelName=S},null,8,["modelValue","onUpdate:modelValue"]),a(c,{type:"danger",plain:"",icon:d(ye),circle:"",onClick:S=>P(p)},null,8,["icon","onClick"])])]),_:2},1024))),256))]),_:1}),a(r,{"label-width":"auto","label-position":"left"},{default:n(()=>[O(a(m,{label:"审核状态"},{default:n(()=>[a(F,{modelValue:e.value.puzzleStatus,"onUpdate:modelValue":l[11]||(l[11]=t=>e.value.puzzleStatus=t)},{default:n(()=>[a(D,{label:0},{default:n(()=>[v("待审")]),_:1}),a(D,{label:1},{default:n(()=>[v("通过")]),_:1})]),_:1},8,["modelValue"])]),_:1},512),[[U,E.value=="update"]]),a(m,{label:"展示排序"},{default:n(()=>[a(_,{modelValue:e.value.displayOrder,"onUpdate:modelValue":l[12]||(l[12]=t=>e.value.displayOrder=t)},null,8,["modelValue"])]),_:1}),a(m,{label:"积分"},{default:n(()=>[a(_,{modelValue:e.value.puzzleScore,"onUpdate:modelValue":l[13]||(l[13]=t=>e.value.puzzleScore=t)},null,8,["modelValue"])]),_:1}),a(m,{label:"出题者"},{default:n(()=>[a(_,{modelValue:e.value.userId,"onUpdate:modelValue":l[14]||(l[14]=t=>e.value.userId=t)},null,8,["modelValue"])]),_:1}),O(a(m,{label:"id"},{default:n(()=>[a(_,{modelValue:e.value.id,"onUpdate:modelValue":l[15]||(l[15]=t=>e.value.id=t)},null,8,["modelValue"])]),_:1},512),[[U,E.value=="update"]])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])],64)}}});export{Sl as default};
